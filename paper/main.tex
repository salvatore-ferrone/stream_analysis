\documentclass{aa}


% \usepackage[draft]{graphicx}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{xcolor}


%\title{Gaps in stellar streams as a result of globular cluster close passages: the case of Palomar~5}
%\title{The impact of globular clusters' close passages on stellar streams: the case of Pal5}
%\title{Globular clusters fly-bys and gap creations in stellar streams.}
\title{Gaps in stellar streams as a result of globular cluster fly-bys}

\subtitle{The case of Palomar~5}

\author{Salvatore Ferrone
       \inst{1,2}
         \and
       Marco Montuori\inst{2}
       \and
       Paola Di Matteo\inst{1}
       \and
       Alessandra Mastrobuono-Battisti \inst{3}
       \and 
       Rodrigo Ibata \inst{4}
       \and 
       Paolo Bianchini \inst{4}
       \and
       Sergey Khoperskov \inst{5}
       \and
       Nicolas Leclerc \inst{6}
       \and 
       Clement Hottier \inst{6}
       \and 
       Eliot Stein  \inst{7}
       \and
       David Valls-Gabaud \inst{8}
       \and
       Owain N. Snaith \inst{9}
       \and
       Misha Haywood \inst{1}
       }

\institute{
    LIRA, Observatoire de Paris, Université PSL, Sorbonne Université, Université Paris Cité, CY Cergy Paris Université, CNRS,75014 Paris, France\\
  \email{salvatore.ferrone@obspm.fr}
  \and
    Dipartimento di Fisica, Universit\`a di Roma ``La Sapienza'', Piazza Aldo Moro
  \and
    Dipartimento di Fisica e Astronomia. ``Galileo Gallilei'' Università di Padova, Vicolo dell'Osservatorio 3 Padova 35122, Italy.
  \and
    Universit\'e de Strasbourg, CNRS, Observatoire astronomique de Strasbourg, UMR 7550, F-67000 Strasbourg, France
  \and
    Leibniz-Institut für Astrophysik Potsdam (AIP), An der Sternwarte 16, 14482 Potsdam, Germany
  \and
    UNIDIA, Observatoire de Paris, Université PSL, CNRS, 92190 Meudon, France
  \and
    DTIS, ONERA, Université Paris Saclay, 91123 Palaiseau, France 
  \and
    LUX, CNRS UMR 8252, Observatoire de Paris, PSL, 61 Avenue de l'Observatoire, 75014 Paris, France
  \and
    Department of Physics and Astronomy, University of Exeter, Stocker Rd, Exeter EX4 4QL, United Kingdom
  }
      
  \date{SUBMITTED TO A\&A 27 JAN 2025; Accepted XXX}

\definecolor{darkgreen}{rgb}{0.0, 0.5, 0.0}


\newcommand{\paola}[1]{\textcolor{magenta}{{#1}}}
\newcommand{\salvatore}[1]{\textcolor{darkgreen}{{#1}}}
\newcommand{\marcook}[1]{\textcolor{green}{{#1}}}
\newcommand{\marcoko}[1]{\textcolor{red}{{#1}}}
\newcommand{\qmar}[1]{\textcolor{brown}{{#1}}}



\begin{document}




\abstract
  %  mention that only one Galactic model should be sufficient to avoid criticism
  {Thin stellar streams, such as those resulting from the tidal disruption of globular clusters, have long been known and used as probes of the gravitational potential of our Galaxy, both its visible and dark contents. In particular, in the literature, we commonly interpret the presence of under-density regions, or gaps, along these streams as being due to the close passage of dark matter sub-halos. }
 % aims heading (mandatory)
  {In this work, we investigate the perturbations induced on streams by the passage of dense stellar systems, such as globular clusters themselves, to test the possibility that they may cause the formation of gaps as well. In particular, we focus on the study of the stream \textbf{\paola{generated by a cluster with characteristics (mass, size, and orbit) similar to the current characteristics}} of Palomar~5, a well-known globular cluster in the Galactic halo, which has particularly long tidal tails.  }
 % methods heading (mandatory)
  {For this purpose, we used a particle-test code to simulate \textbf{\paola{the formation and evolution of the stream}} when subjected to the Galaxy's gravitational field plus its whole system of globular clusters.}
 % results heading (mandatory)
  {Our study shows that the \textbf{\paola{such a stream}} can be strongly perturbed by the close passage of other clusters, in particular of NGC~2808, NGC~7078, and NGC~104, and that these perturbations induce the formation of gaps in the tails.}
 % conclusions heading (optional), leave it empty if necessary
  {These results show that globular clusters can induce gaps in \textbf{\paola{cold}} streams--just as others have shown that other baryonic components such as giant molecular clouds and the galactic bar may as well. Therefore, a future work that attempts to infer the dark matter sub-halo distribution from stellar stream gaps must include the contributions from globular clusters.}


\maketitle
% \nolinenumbers
\section{Introduction}


  % Over a century ago, \citet{1933AcHPh...6..110Z} postulated the existence of dark matter to explain the excessively large velocity dispersions of galaxies within their galaxy clusters. Since then, mounting evidence has been assembled to support this claim. \citet{1970IAUS...38..351F,1970ApJ...161..802F} elaborated on the dynamics of disk galaxies and briefly acknowledged in the appendix of his paper that disk models cannot fully explain the rotation curves of NGC~300 and M~33 and that there must be the same amount of mass or more that is undetected and beyond the extend of the galaxies to explain their kinematics. Concurrently, \citet{1970ApJ...159..379R} studied the rotation of Andromeda and observed it to be flat---not decreasing as one would expect from a gravitational potential with more mass concentration in the center. Eventually, astronomers returned to Zwicky's non-luminous matter to explain these fast-rotating disks, as discussed in \citet{1983SciAm.248f..96R}'s review.
  
  % Beyond the Galactic scale, dark matter is essential for explaining many cosmological phenomena. For instance, the Planck mission \citep{2020A&A...641A...1P} was designed to study the Cosmic Microwave Background (CMB), whose spectrum closely follows that of a black body with a peak temperature in the millimeter wavelength range, corresponding to approximately 2.725~K. However, there are slight temperature variations on the order of one part in ten thousand. Notably, the colder regions of the CMB temperature map correlate with whole-sky gravitational lensing maps \citep{2020A&A...641A...8P}--since the photons lost energy as they escaped the gravitational wells. The $\Lambda$~Cold Dark Matter ($\Lambda$CDM) model accounts for these observations almost perfectly, proposing that dark matter exists and that its distribution originated from stochastic quantum fluctuations within the first second of the universe, which led to density variations. These variations propagated as the universe expanded, shaping the large-scale structure and distribution of galaxies we observe today.

  % As laid out in \citet{2021PrPNP.11903865A}'s review, despite significant progress, the true nature of dark matter remains elusive, and scientists continue to search for evidence of its existence beyond its gravitational effects on cosmic and Galactic scales. A key focus today is detecting dark matter on sub-galactic scales because, at these scales, different cosmological scenarios predict different lumpiness of the halos.
    
  % \citet{2019Galax...7...81Z} provides a review of the different proposed mechanisms of forming dark matter haloes theoretically and how to model them practically, showcasing how different assumptions for the fundamental particle behavior of dark matter propagate to the mass and size distribution of sub-haloes on the galactic scale. The authors rightly state that until particles are discovered, $\Lambda$CDM remains a hypothesis. Since the true nature of dark matter is elusive, the possibilities for sub-galactic behavior and structure of dark matter are vast. In turn, obtaining constraints on the distribution of dark matter subhaloes will constrain the particle nature of dark matter. As proposed by \citet{2012ApJ...748...20C}, stellar streams are the most promising tool to limit the number and mass density of the sub-haloes. 

  Stellar streams are several-kpc-long structures formed by the tidal disruption of globular clusters or dwarf galaxies orbiting a host galaxy. These tidal forces arise due to differential gravitational pulls across extended objects, causing stars farther from the galactic center to lag while those closer speed ahead. This stretching creates two tidal tails that trace the cluster's orbit unless in the closest vicinity to the object \citep{2007ApJ...659.1212M}. Numerical predictions of this phenomenon exist since the 1970s \citep[see, for example][]{1975AJ.....80..290K}. 
  
  These predictions occurred well before the first detections of Galactic globular cluster tidal tails \citep{1995AJ....109.2553G}. Interestingly, \citet{1995AJ....109.2553G}'s detections were made nearly contemporary with the discovery of the Sagittarius stellar stream by \citet{1994Natur.370..194I}, which is the closest example of a stream emerging from a dwarf satellite currently interacting with the Milky Way. 
  
  Subsequent studies\footnote{For more subsequent observation detections of tidal debris, i.e., globular cluster stars beyond the tidal radius see the works of: \citet{1997A&A...320..776L, 2000A&A...356..127T, 2000A&A...359..907L, 2001AAS...19910906S, 2003AJ....126..815L,2011ApJ...726...47S,2018MNRAS.476.4814S,2020MNRAS.495.2222S}.} extended Grillmair's findings to other globular cluster streams, but were often limited to the detections of stars still close to the cluster tidal radius, until the discovery made by \citet{2001ApJ...548L.165O,2002AAS...200.1001O, 2003AJ....126.2385O} of long and thin tails outside the Palomar~5 globular cluster. With a mass of $1.34\pm 0.24 \times 10^4 M_{\sun}$ \citep{2019MNRAS.482.5138B}, Palomar~5 is one of the least massive globular clusters in the Galaxy. \citet{2003AJ....126.2385O} showed that its tails contain more mass than the cluster. The works of \citet{2006ApJ...641L..37G} and \citet{2015MNRAS.446.3297K} showed that the tails have an extent of more than $20^\circ$ degrees in the sky. The discovery of its prominent tails stimulated a vigorous and successful search in the following years. New streams were discovered, mostly taking advantage of SDSS data, but also Pan-STARRS and ATLAS  \citep{2006ApJ...643L..17G, 2006ApJ...637L..29B, 2009ApJ...693.1118G, 2012ApJ...760L...6B, 2013ApJ...769L..23G, 2014ApJ...790L..10G, 2015ApJ...812L..26G, 2014MNRAS.443L..84B, 2016MNRAS.463.1759B, 2017ApJ...847..119G, 2014MNRAS.442L..85K}. 
  
  
  \citet{2025NewAR.10001713B} provides a review of stellar stream astronomy, which has entered a new era since the publication of the data from the Gaia astrometric mission \citep{2016A&A...595A...1G}. Gaia's characterization of billions of stars in the Milky Way allows us to look for these structures, coupling photometry, astrometry, and spectroscopy for the brightest stars. The possibility given by Gaia to track stars with coherent movements over the entirety of the sky has led to the discovery of dozens of new streams. For example, \citet{2018MNRAS.477.4063M} developed the \texttt{streamfinder} algorithm and applied it across a series of works \citep{2018MNRAS.481.3442M,  2018ApJ...865...85I, 2019ApJ...872..152I} to discover a multitude of streams.%: Slidr, Sylgr, Ylgr, Fimbulthul, Svol, Gjoll, Leiptr, Phlegeton and Fjorm.  According to the most recent estimates provided by \citet{2020MNRAS.493.4978S}, Fjorm, in particular, has an extension of more than 150 degrees on the sky, which has a projected length more than five times greater than that of Palomar~5. 
  
  The possibility of combining Gaia data with spectroscopic surveys has extended the study of stellar streams beyond the quantification of their orbital properties to a full chemical characterization. For example \citet{2019MNRAS.490.3508L} presents $S^5$, and is one example of a cross-catalog among other works \citep{2020AJ....160..181J, 2021ApJ...911..149L, 2022ApJ...928...30L, 2024MNRAS.529.2413U}. Currently, about a hundred stellar streams are known in our Galaxy. \citet{2023MNRAS.520.5225M} compiled their tracks on the sky into a catalog. Interestingly, only about 20 streams are associated with known Galactic globular clusters.

  One of the interests in studying stellar streams is that they can constrain the gravitational field of their host galaxies, particularly the Milky Way. Compared to the measurement of the HI rotation curve, stellar streams offer the opportunity to investigate the potential of the host galaxy over a wide range of distances, reaching the outermost regions of the halo. For example, \citet{2011MNRAS.417..198V} demonstrated how stellar streams can infer the mass and scale parameters of dark matter halos using various amounts of observational data, from basic right ascension and declination to full six-dimensional phase space information. \citet{2018ApJ...867..101B} reviewed this concept from an information-theoretic point of view, identifying which orbits and configurations of stellar streams yield the most information about the Galactic potential. However, using single streams to constrain the potential led to ambiguous and non-converging results. For example, \citet{2010ApJ...718.1128L} made use of the Sagittarius stream to infer that the dark matter halo of our Galaxy has a triaxial shape \citep[but see also][]{2004MNRAS.351..643H, 2005ApJ...619..800J, 2005ApJ...619..807L}; \citet{2016ApJ...833...31B} concluded that the dark matter halo of our Galaxy is nearly spherical at the distances of the Palomar~5 and GD-1 streams. The two contrasting results could also show that the halo is triaxial at one distance yet spherical at another--highlighting the need for streams at different distances to map the halo shape. Recently, \citet{2024ApJ...967...89I} constructed a Milky Way model by applying a Monte Carlo Markov Chain (MCMC) fitting procedure. This method identified the set of potential parameters in an axisymmetric model of the Milky Way that best reproduces all observed stellar streams.


  % \citet{2022MNRAS.516.5331M} showed that many metal-poor streams exist in the Milky Way. On the other hand, it is possible that some globular clusters do not lose a significant number of stars to create tidal tails. For instance, \citet{2022A&A...667A.112V} demonstrated that clusters existing in dark matter subhaloes could place the tidal radius far beyond their half-mass radii and shield stars from escape. Another factor is indeed detectability. Additionally, there are many clusters in the internal region of the galaxy, a region over which \texttt{streamfinder} was not applied since the high stellar density implies a computational cost that is far too expensive. Also, \citet{2018MNRAS.474.2479B} demonstrates that internal dynamics preferentially kick out small stars first, which have lower luminosities. Earlier escape times place larger distances to the cluster, making detection more difficult. 
  
  
  Beyond the global visible and dark mass distribution streams, they can also be used to infer the granularity of the dark matter, that is, the mass and density of the sub-halos populating our galaxy. According to simulations by \citet{2008MNRAS.391.1685S}, $\Lambda$~Cold Dark Matter ($\Lambda$CDM) predicts that galaxies grow hierarchically, with dark matter clumps forming at a wide range of masses and sizes. These clumps, or \textit{sub-halos}, are predicted to follow a mass distribution with a power-law slope slightly shallower than -2.0. \citet{2012Natur.481..341V} detected the smallest observed dark matter halo through gravitational lensing in an Einstein ring with a mass of $10^8$ solar masses. However, some models predict that dark matter clumps could exist down to at least the mass of Earth-like planets \citep[see][and discussion in \citet{2021arXiv211101148A}]{2005JCAP...08..003G}. 

  \citet{2002MNRAS.332..915I} first suggested that dark matter sub-halos could influence stellar streams by diffusing their orbital elements. Later, \citet{2012ApJ...748...20C} expanded this idea, proposing that sub-halos could create gaps in stellar streams during flyby encounters, where a sub-halo approaches closely enough to a segment of a stream and significantly changes the orbits of the closest stars.  \citet{2012ApJ...760...75C, 2013ApJ...768..171C} applied this idea and looked for the presence of gaps in the well-known Palomar~5 and GD-1 streams, concluding that the density variations found in their streams were consistent with expectations from $\Lambda$CDM models. \citet{2019ApJ...880...38B} provided further observational evidence for this idea, identifying a gap and a spur in the GD-1 stream that they could not explain by known objects, such as globular clusters, and which they suggested was due to the close passage of a dark matter sub-halo. Interestingly enough, as stated in \citet{2019ApJ...880...38B}, the recovered properties of this sub-halo (mass and size) were denser than those with the $\Lambda$CDM mass-size relationship presented in \cite{2017MNRAS.466.4974M}. The works above are only a few of a much more extensive literature that has explored the impact of dark matter sub-halos in simulated streams \citep{2016ApJ...828L..10H, 2021MNRAS.507.1999H, 2021JCAP...10..043B, 2024arXiv240402953H, 2024arXiv241021174N}, or searched for their traces in observed streams \citep{2016MNRAS.460.2711T, 2017MNRAS.470...60E, 2020ApJ...889...70B, 2020ApJ...892L..37B}.

  In contrast, a more limited number of works have been interested in understanding whether other structures, e.g., from baryonic matter, can cause variations in the density of streams and gaps that can be assimilated and confused with those produced by dark matter sub-halos.  Among these works, it is worth mentioning the results of \citet{2017NatAs...1..633P} that suggest how the presence of the bar at the center of the Galaxy can perturb the characteristics of a stream such as Palomar~5 and generate gaps along its tail. That the Galactic bar could have an influence on stream morphology was also discussed by \citet{2016MNRAS.460..497H} and \citet{2016ApJ...824..104P}, in the case of the Ophiuchus stream \citep{2014MNRAS.443L..84B}. Besides the Galactic bar, giant molecular clouds can also produce gaps in stellar streams, as shown by \citet{2016MNRAS.463L..17A}. All these works thus indicate that baryonic structures can play an important role in tail morphology. In this context,  an extensive numerical study, specifically focused on modeling the tails of Palomar~5, under the influence of the Galactic bar, spiral arms, giant molecular clouds, and globular clusters, has been realized by \citet{2019MNRAS.484.2009B}, who concluded that both the influence of the bar and that of the giant molecular clouds can leave imprints in Palomar~5 tidal tails similar to those left by dark matter sub-halos. In contrast, they found the effect of globular clusters to be negligible. 
  
  Few studies have specifically investigated the effect of globular clusters on stellar streams. \citet{2017MNRAS.470...60E} concluded that globular clusters could not be responsible for the observed density variations in the tails of Palomar~5. Their analysis focused on the observed gaps' characteristics and involved constraining progenitor properties using reconstructive modeling. By trial and error, they identified a specific configuration of masses, sizes, impact parameters, times of impact, and relative velocities for two perturbers that successfully reproduced the observed density distribution. However, as we do in this work, their method does not perform full forward modeling of the entire globular cluster system on Palomar~5's stream. While they suggest that the impact rate of globular clusters is likely less significant—given their lower abundance compared to the expected dark matter sub-halos population-they do not explore this aspect in detail. However, they state that it is an avenue for future investigation. 
  
  More recently, \citet{2022ApJ...941..129D} have examined the possibility that gaps in the GD-1 stellar stream could be due to the close passage of globular clusters, concluding that this scenario is improbable. These first works suggest that the impact of globular clusters on stellar streams is negligible. This result does not necessarily need to be the general case, especially for streams of clusters such as Palomar~5, which live in the inner 20~kpc of the Galaxy, where many other globular clusters also orbit. For example, \citet{2023A&A...678A..69I} showed that a globular cluster can even collide with other clusters, which implies that cluster stream collisions should happen much more frequently since streams are far more extended than clusters. 
  
  In the present study, we wish to fill this gap in the literature on numerically modeling cluster-stream interactions. We seek to quantify the importance of the effects of passing globular clusters in the vicinity of streams to understand whether these systems can also be effective, and how often they alter the distribution of stars in the tails and produce underdense regions or gaps. To this end, on the following pages, we will present the results of simulations of the streams of Palomar~5, subject to the gravitational interaction with the set of 165 Galactic globular clusters for which positions and velocities are known to date and for which orbits can therefore be reconstructed \citep{2021MNRAS.505.5957B}. We chose to simulate \textbf{\paola{streams formed from a cluster with the current characteristics of}} Palomar~5 because \textbf{\paola{this latter}} is a halo cluster with extended tails and because it is a cluster for which the effect of baryonic structures on its stream has already been studied. As we will show, and in tension with previous claims, the close passage of other clusters with \textbf{\paola{such a stream}} is not rare. Indeed, in the 50 simulations we ran, we find the formation of numerous gaps, for an average of 1.5 gaps per simulation, generated by 18 different clusters among the whole system of Galactic globular clusters.

  \begin{figure*}
    \centering
    \includegraphics[width=\linewidth]{stream_on_sky_Pal5_monte-carlo-009_pouliasis2017pii-GCNBody_pouliasis2017pii.png}
    \caption{Simulated Palomar~5 stream created by modeling the host cluster as a Plummer sphere disrupting within an axis-symmetric Galactic potential plus the gravitational effect of 164 other galactic globular clusters. The top panel shows the distribution of star particles that escaped the cluster due to tidal forces. The bottom panel shows the 1D density profile marginalized over longitude. The gray fill shows a reference simulation that uses the same conditions to produce the stream but does not include the other globular clusters. The large central peak in density is of the particles still bound to Palomar~5. $\ell_0,b_0$ are located Palomar~5's cluster's center of mass. Two large gaps are present due to the passage of two globular clusters. $N_p$ indicates the number of particles in a bin, while $N$ is the total number of particles, which is 100,000.}
    \label{fig:stream_on_sky}
    \end{figure*}


\section{Methods}
  The most accurate model of the Palomar~5 stream would involve full modeling of the internal dynamics of the cluster, which would mean computing $N$-body interactions with a $\mathcal{O}(N^2)$ computation time, stellar evolution, supernovae, an initial mass distribution, treatment of binary star systems, etc. \citep[for such an example, see][]{2021NatAs...5..957G, 2016MNRAS.458.1450W}. Instead, we opt for solving the \textit{restricted-three body problem}, or as known as the \texttt{particle-test method} as we did for \citet{2023A&A...673A..44F}, which we describe here for completeness. As demonstrated by \citet{2012A&A...546L...7M}, although the restricted three-body problem neglects the internal evolution of the cluster, it still reproduces very similar stream properties since the model captures key extra-cluster physics, such as disk shocking and epicyclic stripping.\\
  \textbf{\paola{Below, we first present the approach used to include the Galactic globular cluster system in our modeling (Sect.~\ref{numerical_meth}), highlighting the similarities and differences with respect to what we did in \citet{2023A&A...673A..44F}; we then summarize the method used to model the mass loss from the cluster (Sect.~\ref{sec:mass_loss}) and finally discuss the quality of the numerical integration (Sect.~\ref{num_quality}). }}

  \subsection{Numerical Methodology}\label{numerical_meth}
    We begin by extracting positions in the sky, proper motions, line-of-sight velocities, and distances, as well as masses and half-mass radii, of 165 globular clusters from the Galactic globular cluster catalog by \cite{2021MNRAS.505.5957B}.\footnote{The Baumgardt catalog has been assembled across a series of works, see: \cite{2020PASA...37...46B,2019MNRAS.482.5138B,2018MNRAS.478.1520B}. The catalog can be found on the World Wide Web at \href{https://people.smp.uq.edu.au/HolgerBaumgardt/globular/}{https://people.smp.uq.edu.au/HolgerBaumgardt/globular/}.} We then convert the initial conditions from sky coordinates into a Galactocentric reference frame, by adopting a velocity for the local standard of rest of $v_{\text{LSR}} = 240$~km~s$^{-1}$ and a peculiar velocity of the Sun equal to $(U_\odot, V_\odot, W_\odot)=(11.1, 12.24, 7.25)$~km~s$^{-1}$, as reported by \citet{2012MNRAS.427..274S}.  We set the Sun's position to $(x_\odot,y_\odot,z_\odot) = (-8.34,0,0.027)$~kpc. We took the vertical position above the disk from \citet{2001ApJ...553..184C} and the distance of the Sun to the Galactic center from \citet{2014ApJ...783..130R}. These transformations were performed using \texttt{astropy} \citep{2013A&A...558A..33A}.

    For the Galactic potential, we used the second model from \citet{2017A&A...598A..66P}, a superposition of a thin disk, thick disk, and dark matter halo, with masses and scale lengths provided in Table~1 of \citet{2023A&A...673A..44F}. This model is time-independent throughout our simulations. This model satisfies a series of observational constraints such as local solar, stellar density, the Galactic rotation curve, etc., similarly to other Galactic models such as \texttt{MWpotential2014} from \citet{2015ApJS..216...29B} and \texttt{McMillian2017} from \citet{2017MNRAS.465...76M}. However, we use only one Galactic potential to balance data volume and computation time, which should suffice. \citet{2021MNRAS.505.5978V} found that only a few outer globular clusters are strongly affected by different potential models. Generally, kinematic uncertainties are the dominant factor in differences between orbital solutions per cluster. Similarly, \citet{2024MNRAS.528.5189G} generated a globular cluster mass-loss catalog using seven different potential models and found their debris distributions to be rather model-independent, similar to \citet{2023A&A...673A..44F}. While the clusters' exact positions in time may depend on the model, we assert that interaction rates and stream formation are largely independent of the choice of the Galactic potential model.
    
    Lastly, we select an integration time of 5~Gyr as a compromise between maximizing interaction statistics and modeling the galaxy as a time-independent, constant mass distribution. \citet{2023A&A...673A.152I} analyzed the orbits of the Galactic cluster population using the same initial conditions as in this work within five live Milky Way-like potentials from IllustrisTNG \citep{2018MNRAS.473.4077P}. They found that in all sampled potentials, orbital changes remain minimal over 5~Gyr, becoming significant only at earlier look-back times when the host galaxy had significantly less mass or was undergoing a merger event.


    \subsubsection*{ \texttt{Full} simulations}
    There is a primary methodological departure from \citet{2023A&A...673A..44F}.  In that work, globular clusters evolved under the gravitational effect of the Galaxy only, while now we also include the effect of all the other Galactic globular clusters by considering the direct $N$-body interactions between them. First, all clusters are represented by Plummer spheres, each with its own mass and half-mass radius as reported in the Baumgardt catalog \citep{2021MNRAS.505.5957B}. For the remainder of this paper, the \texttt{full} simulations consider the gravitational forces from the globular cluster interactions. \\
    For these simulations, we proceed in two steps:
      \begin{enumerate}
          \item First, starting from the Galactocentric positions and velocities of all 165 Galactic globular clusters, we integrate their orbits back in time for 5~Gyr under the influence of the Galaxy itself and their mutual influence. In the backward integration, the system of equations of motion for the globular clusters is thus: 
          \begin{equation}
          \ddot{\vec{r}}_i = -\nabla \Phi + \left.\sum_{j\neq i}^{N_{GC}} \frac{Gm_j}{\left(|\vec{r}_j - \vec{r}_i|^2 + b_j^2\right)^{3/2}}\right. \left(\vec{r}_j - \vec{r}_i\right),
          \end{equation}\label{eq:GCNBody} 
          \noindent where $\vec{r}$ indicates the galactocentric position vector, the index $i$ indicates the globular cluster of interest; the index $j$ indicates the other globular clusters that are summed over. $N_{GC}$ is the total number of globular clusters, which in this study is 165, $m_j$ is the mass of the j-th cluster in the sample, $b_j$ is its Plummer scale radius, and $\vec{r_j}$ is its galactocentric position. $\Phi$ represents the same Galactic smooth potential that we discussed previously\citep[][Model~II, in the present case]{2017A&A...598A..66P}. Note that the masses and sizes of the globular clusters are kept constant in these simulations and are not allowed to vary with time, which means that we do not consider their internal evolution. In the Discussion section, we discuss the implications of the modeling limitations.
      
        \item Once the we find the positions and velocities of the entire globular cluster system 5~Gyr ago, we sample Palomar~5 with 100,000 particles from a Plummer distribution, taking the mass and half-mass radius from the Baumgardt catalog \paola{can you add here the current values of mass and size of Pal 5 in Baumgardt?}. We then integrate the evolution of these particles forward in time to the present day by taking into account that each particle feels the gravitational potential of the Galaxy, that of its host cluster, and that of all the other clusters in the Galaxy. Note that we do not take self-gravity among particles into account. The particles experience the gravitational field yet do not contribute to it, which is a common assumption made in Galactic dynamics since the mass of an individual star is negligible compared to the mass of the larger dynamical system. The equation of motion of a generic particle among the 100,000 that populate Palomar~5 is thus: 
        \begin{equation}
          \ddot{\vec{r}}_p = -\nabla \Phi + \left.\sum_{j}^{N_{GC}} \frac{Gm_j}{\left(|\vec{r}_j(t) - \vec{r}_p|^2 + b_j^2\right)^{3/2}}\right. \left(\vec{r}_j(t)- \vec{r}_p\right),
          \end{equation} \label{eq:equation_of_motion_particle} where the index $p$ represents one of the 100,000 particles of interest, $\vec{r_p}$ being its position, and $j$ indexes over the globular clusters as in Eq.~\ref{eq:GCNBody}. Note that in Eq.~\ref{eq:equation_of_motion_particle}, the positions of the globular clusters are time-dependent since they are being loaded during this step and not computed, unlike Eq.~\ref{eq:GCNBody}. 

      \end{enumerate}




        The procedure described so far has been repeated 50 times, generating a new set of initial conditions each time, given the uncertainties on proper motions, line-of-sight velocities, distances to the Sun, and masses of all clusters, as reported in the Baumgardt catalog. We handle these uncertainties through a Monte-Carlo approach by sampling them with a Gaussian distribution and considering the covariance term between the proper motions. We use the most probable values for the initial conditions in the first simulation. We sample the uncertainties for all globular clusters. Additionally, for each resampling of Palomar~5's mass, we also resample the distribution of the 100,000 star particles. 


      During the integration, we save intermediate snapshots to facilitate the analysis of stellar streams and the effects of cluster impacts. Specifically, for each realization of the Palomar~5 stream, we saved $5000$ in snapshots, equivalent to a temporal resolution of 1 million years. We provide the parameters that specify our data volume in Table~\ref{tab:data_volume}. Using single precision floating point numbers, the size of our simulations is approximately:
    \begin{equation} \label{eq:data_volume_estimate}
      N_p \times N_{\textrm{ts}}\times N_{\textrm{phase}}\times N_{\textrm{sampling}} \times 4~\textrm{bytes}\approx 600~\textrm{Gb}.
    \end{equation}

    \begin{table}[h]
      \centering
      \begin{tabular}{|c|c|c|c|}
          \hline
          $N_p$ & $N_{\textrm{ts}}$ & $N_{\textrm{phase}}$ & $N_{\textrm{sampling}}$ \\
          \hline
          $100000$ & $5000$ & $6$ & $50$ \\
          \hline
      \end{tabular}
      \caption{The parameters determining the data volume of this experiment. where $N_p$  is the number of particles, $N_{\textrm{ts}}$ is the number of time-steps saved, $N_{\textrm{phase}}$ is the number of phase space coordinates, and $N_{\textrm{sampling}}$ is the number of Monte-Carlo samplings of the initial conditions.}
      \label{tab:data_volume}
    \end{table}

  \subsubsection*{ \texttt{Reference} simulations}

    To quantify the impact of globular cluster passages on the density of the Palomar~5 stream, we performed a second set of simulations, which we refer to as the \texttt{reference} simulations in this paper.  These \texttt{reference} simulations use the same 50 sets of initial conditions as the \texttt{full} simulations, the same Galactic potential, but exclude mutual interactions between globular clusters. The approach adopted for this second set of simulations is thus equivalent to that adopted already in \citet{2023A&A...673A..44F}. In Eq.~\ref{eq:GCNBody}, only the gradient of the Galactic potential is considered. In Eq.~\ref{eq:equation_of_motion_particle}, of the second term on the right side of the equation, only the influence of Palomar~5's Plummer sphere on Palomar~5's particles is considered. In other words, the sum iterates over only one globular cluster, the host. We omit all interactions with the other clusters.

\textbf{\paola{\subsection{Mass loss}}}\label{sec:mass_loss}

\textbf{\paola{Each of the 100,000 particles that initially populate the cluster undergoes, over time, acceleration due to the Pal~5 potential, whose mass and half-mass radius we assume to be fixed over time, and to the Galactic potential. At each time step, a certain number of particles will therefore acquire sufficient energy to no longer be gravitationally bound to the cluster itself and thus go on to populate the streams, whose mass and spatial extent grow over time. It is important to note that in the approach used:}}
\textbf{\paola{
\begin{enumerate}
    \item The masses and sizes of the clusters (and therefore the parameters of the Plummer potentials) do not change over time, which is a blatant simplification, because in a self-consistent approach, these parameters would vary. 
    \item We use the same initial conditions for Pal~5 progenitor as it has today, and this is also a simplification, since Pal~5 - 5 Gyr years ago - must have contained at least part of the mass estimated today in its tails\footnote{\textbf{\paola{We use the same approach (i.e. time-independent masses and sizes) to model the whole set of globular clusters.}}}. 
\end{enumerate}}}

\textbf{\paola{The assumption in point 2 is a direct consequence of the approach described in point 1. Starting from a cluster with mass and size similar to the current ones can lead to streams with lower velocity dispersions than those we would have obtained if we had used a self-consistent approach. In a future article, we will report on the study of gap survival times depending on the masses and sizes of progenitor clusters (Ferrone et al, in prep). We note, however, that simplifications of this kind are not uncommon in literature. \citet{2017NatAs...1..633P} discussed the formation of gaps in the Pal~5 tails and assumed a time-independent mass of $50,000 M_\odot$ for Pal~5, over the last 4~Gyr; \citet{2017MNRAS.470...60E} adopted a N-body approach to simulate Pal~5 stream, but used Pal~5 current conditions as their progenitor's initial conditions; \citet{2019MNRAS.484.2009B} simulated the Pal~5 stream as emerging from a stellar system with a velocity dispersion of 0.5~km/s (similar to that of particles escaping from our cluster, as we have verified). \\The characteristics of the streams modeled in this paper may be considered more representative of those of clusters that are now completely dispersed, i.e. it is conceivable that completely dispersed globular clusters that left behind a population of 'orphan' streams passed through characteristics similar to those of Pal~5 today (small masses and extended radii). In this sense, the initial conditions chosen (in terms of internal parameters) could be considered more representative of those of streams found in the Galaxy and for which the progenitor is now dissolved \citep[see, for example, the population of streams without progenitors described by][]{2024ApJ...967...89I} than those currently typical of Galactic globular clusters\footnote{\textbf{\paola{In this regard, we recall that \citet{2014ApJ...795...95B} modeled the GD-1 stream as the result of the dissolution of a cluster with a mass of $2 \times 10^4 M_\odot$, and a tidal radius of $0.07$~kpc.}}}.  }}




  \subsection{Numerical Stability}\label{num_quality}

    We used a leapfrog integrator because of its ability to preserve phase-space volume and conserve the Hamiltonian with each integration step. For instance, this method is preferable to a Runge-Kutta scheme, which can introduce non-physical and significant numerical errors in systems that require long-term stability and energy conservation. One drawback of the leapfrog integrator is that it requires a uniform time step across the entire computation, leading to unnecessary computations for a particle after it escapes from the host cluster. However, energy conservation and phase-space volume preservation are paramount when modeling stellar streams. The time step was, therefore, set to be small enough to conserve energy for the most interior particles within the cluster---ensuring that a higher mass loss did not arise from numerical error. We found that a time-step of 10,000 years was adequate to maintain energy conservation, with a median variation of $10^{-12} \frac{\Delta E}{E_0}$, where $E_0$ is a particle's initial energy, and $\Delta E$ is the difference between its final and initial energy. 
    
    We also checked the \textit{reverse integrability} of the globular cluster system for the \texttt{reference} simulations. By reverse integrability, we mean the integrator's capability to track the cluster backward in time and then re-integrate it forward along the same trajectory. Integrating point masses in a static axis-symmetric potential conserves $L_z$ and $E$, which create regular periodic and non-chaotic orbits. Therefore, any drift would arise from purely numerical error. We selected a timestamp for which the drift in the final position after forward integration, compared to the initial position from the backward integration, was consistently at least two orders of magnitude smaller than the Plummer scale radius used for Palomar~5. This high precision ensures that no fictitious numerical forces influence the system, preventing any artificial mass loss or retention of star particles.

\section{Results}



  \subsection{Overview}

    \begin{figure*}
      \centering
      \includegraphics[width=\linewidth]{decomposition-monte-carlo-009-with-3-gaps-domidpoint-shift.png}
      \caption{Density maps of Palomar~5's stream in the tail coordinate system. The color scale represents normalized particle counts (total: 100,000). The top panel shows the \texttt{full} simulation with three gaps on the stream's right-hand side. The next three panels depict simulations with identical initial conditions but exclude the gravitational influence of all clusters except those forming a given gap. The \texttt{Reference} simulation omits the influence from other globular clusters. The bottom panel compares Palomar~5's observed stream length to the \texttt{Reference} simulation, using the same Monte Carlo realization as Fig.~\ref{fig:stream_on_sky} and \texttt{Sampling~009} of Fig.~\ref{fig:gallery2}.}
      \label{fig:decomposition}
    \end{figure*} 
    
    \begin{figure*}
      \centering
      \includegraphics[width=\linewidth]{histogram_impact_time.png}
      \caption{The simulation time when the impacts occurred for all gap-causing flybys summed over all 50 simulations. Each perturbing cluster is labeled and color-consistent. We report the time axis in simulation units, with 1~s~kpc~km~$^{-1}$ corresponding to roughly 1~Gyr. Note that the plot breaks the y-axis to accommodate the large number of encounters from NGC~2808 without overshadowing the other interactions.}
      \label{fig:histogram_impact_time}
    \end{figure*}


    
    The presence of the other globular clusters affects the properties of the Palomar~5 stream. Fig.~\ref{fig:stream_on_sky} presents an obvious example of this effect, which we selected for its prominent gaps. Two of these gaps are visible in Galactic coordinates and become even more apparent when marginalizing over latitude to reconstruct the 1D density profile of the stream as a function of longitude.     

    Regarding the shape of the density distribution, the central peak corresponds to the still-intact globular cluster whose stars have not yet escaped. The stream's density peaks are the same order as the cluster itself, which is inconsistent with reality; the cluster's peak density should be higher than the stream's. Of course, this discrepancy is a result of our modeling choices. Since we use the present-day mass and radius for Palomar~5 for the whole simulation duration, the system is less dense than it should have been. In turn, our simulations have a strong initial mass loss, which adds to the amplitudes of the profile density peaks of Fig.~\ref{fig:stream_on_sky}. This inaccuracy is acceptable for the scope of this work. First is that Palomar~5's tails indeed have more mass than the cluster itself. \citet{2017ApJ...842..120I} reports that there could be three times as much mass in Palomar~5's tails as the cluster itself. Secondly, the exact form of the density distribution is less important than having a population of particles present that can probe a cluster flyby event.
    
    To compare the \texttt{reference} and \texttt{full} simulations more quantitatively, we work in the tail coordinate system, in which the stream's central axis aligns with the cluster's orbit. We based this coordinate system on the work of \citet{2004AJ....127.2753D} and present it in Fig.~\ref{fig:TailCoordinates}. Briefly, in this system, the $x_{\textrm{tail}}$ coordinate represents the position of a particle along the orbit relative to the globular cluster. Positive values of $x_{\textrm{tail}}$ are ahead of the cluster, while negative $x_{\textrm{tail}}$ is behind the cluster. The $y_{\textrm{tail}}$ coordinate measures the particle's distance within the orbital plane, where positive values indicate that the particle is farther from the Galactic center and negative values indicate that it is closer. Fig.~\ref{fig:decomposition} shows a comparison between one of the 50 realizations of the Palomar~5 stream, taking into account the gravitational interactions with all other globular clusters in the Galaxy (top panel) and omitting them (bottom panel). This comparison clearly shows the presence of two wide ($\sim$100~pc and $\sim$1~kpc) gaps in the leading tail and of a more subtle under-density at $x_{\textrm{tail}}\sim 5$~kpc (we refer the reader to Appendix~\ref{sec:gap_detection} for a detailed description of the under-densities and gaps detection method). 
    
    To find out which globular clusters were responsible for creating these gaps and when close passages took place, we estimated the gravitational acceleration along the orbit of Palomar~5. We represented it in the ($t$, $\tau$) space. $t$ is the simulation time, and $\tau$ indicates how long it will take for Palomar~5 to reach a given point in its orbit or how long ago it passed. The use of $\tau$ is advantageous because the growth of the stream is approximately linear in $\tau$. 
    On the other hand, streams in physical space grow linearly. Yet, their eccentricity modulates this growth with periodic expansion and contraction depending on the orbital phase \citep[see the top panel of Fig.~5.][for an example]{2016MNRAS.457.3817S}. Adopting this time-space and reporting the gravitational acceleration along the Palomar~5 orbit in this space, identifying the globular clusters that produced the perturbation and the time it occurred becomes straightforward. We refer the reader to Appendix~\ref{sec:Perturber_Identification} for an in-depth procedure description. In this way, we could identify that the clusters responsible for creating gaps in the simulation of the Palomar~5 stream reported in Fig.~\ref{fig:decomposition} are NGC~2808, NGC~7078, and NGC~104 and that their close passages occurred 200~Myr, -1.9, and -2.1~Gyr ago, respectively. 
    
    To further probe whether the three clusters above are responsible for producing the gaps observed in this simulation, we conducted additional experiments by including only the perturbation of each cluster at a time and neglecting the gravitational perturbations of all the other clusters in the Galaxy.
    
    To verify that the three suspected clusters are responsible for producing the gaps, we conducted experiments by including one perturbed at a time and excluding all others. We present these results in the middle panels of Fig.~\ref{fig:decomposition} and clearly show that NGC~2808, NGC~7078, and NGC~104 are the clusters responsible for creating the under-dense regions observed in the leading tails of Palomar~5. It is worth noting that the times at which the passages of these clusters occurred, according to our analysis, are in agreement with the observed width of the corresponding gaps: the encounter with NGC~2808 being very recent (only 200~Myr ago), its induced gap is still very thin, because it takes time for a perturbation to grow into an extended gap, as it is the case for those induced by the passages of  NGC~7078 and NGC~104, which occurred in earlier times. It is also interesting to emphasize that gaps as thin as those generated by the passage of NGC~2808, 200~Myr ago, can be detected by working in the tail coordinate system and by making a comparative analysis (\texttt{full} versus \texttt{reference} simulations): they are so thin that they cannot be directly identified in Galactic coordinates (see Fig.~\ref{fig:stream_on_sky}).\\

    The analysis presented in Fig.~\ref{fig:decomposition} has been repeated for the whole set of simulations, and Appendix~\ref{sec:gallery_of_gaps} reports all of them for completeness. For all of the streams, morphologically speaking, the only changes appear to be the existence of gaps or not. We do not observe a thickening of the streams due to an increased velocity dispersion. 
    
    From this analysis, we can derive a statistical view of 1) the number of gaps generated on the Palomar~5 stream by the system of Galactic globular clusters, 2) the clusters that generated these gaps, and the time history of these perturbations. From this, we can then quantify 3) the properties of the perturbers (their masses, sizes, and orbital parameters) as well as 4) the impact geometry of the encounters, which allows us to understand which encounters are more favorable to generate gaps in the Palomar~5 stream. In the following, we will present the results of this analysis, addressing points 1) and 2).





  \subsection{The history and statistics of gap creations in Palomar~5 stream}\label{sect:history}
  

      


    By applying the methodology described above to the whole set of simulations, we can reconstruct the history of close passages of Galactic globular clusters to Palomar~5's stream in the last 5~Gyr, which -- we remind the reader -- is the time interval investigated in our simulations.  Fig.~\ref{fig:histogram_impact_time} and Table~\ref{tab:gaps_per_perturber} present results of this analysis. NGC~2808 impacted Palomar~5's stream about 200 Myr ago in 44 out of 50 simulations, creating a small gap at a similar position to the one reported in Fig.~\ref{fig:decomposition} in each case. Since this interaction occurred less than one orbital period ago, despite the uncertainties, the orbital solutions remain similar and thus produce consistent results across all simulations. However, as we continue to turn back time further, the uncertainties in the initial conditions allow the various orbital solutions to diverge from one another. Thus, in one configuration, a cluster can impact the stream at a given time, and yet at the same moment, in a different set of initial conditions, it could be on the other side of the galaxy. \textbf{\paola{Interestingly, some gaps, formed by close passages occurred early on, can persist for several billions years in our models and be visible until the end of the simulation -- as it is the same for NGC~104, which produces the gap visible in Fig.~2 at about 8~kpc from the cluster. We will discuss how these gaps can survive for so long in Appendix~\ref{sec:gaps_vs_gcmass}. }}
    

    \begin{table}[h]
      \centering
      \begin{tabular}{|ll|ll|ll|}
      \hline
      NGC2808 & 44 & NGC7089 & 5 & NGC5272 & 4 \\
      NGC6584 & 3 & NGC6341 & 2 & NGC6656 & 2 \\
      NGC104 & 2 & NGC3201 & 1 & NGC5634 & 1 \\
      NGC5286 & 1 & NGC362 & 1 & NGC5824 & 1 \\
      NGC6356 & 1 & NGC6333 & 1 & NGC6715 & 1 \\
      FSR1758 & 1 & NGC7078 & 1 & Pal10 & 1 \\
      \hline
      \end{tabular}
      \caption{The number of gaps created by each perturber across all 50 simulations of Palomar~5's tidal tail. These data are color-coded and illustrated in Fig.~\ref{fig:histogram_impact_time}.}
      \label{tab:gaps_per_perturber}
    \end{table} 
    
    In total, we report the finding of 73 gaps in our 50 simulations, which is, on average, 1.5 gaps/simulation. Eighteen different perturbers provoke the gaps. Table~\ref{table:gap_distribution} presents the distribution of the number of gaps appearing per simulation. If we consider NGC~2808 an outlier and exclude it from the experiment, we observe an average of 0.6 gaps per simulation.  
    
    \begin{table}[h]
      \centering
        \begin{tabular}{|l|c|c|c|c|c|}
          \hline
          Number of Gaps & 0 & 1 & 2 & 3 & 4 \\
          \hline
          Number of Sims. & 4 & 25 & 16 & 4 & 1 \\
          \hline
        \end{tabular}
        \vspace{0.5cm}
      \caption{Occurrence of gaps in Palomar~5 streams,  in our simulations. More specifically, the table reports the number of simulations (second row) for a given number of gaps (first row). }\label{table:gap_distribution}
    \end{table}

    We need a more sophisticated statistic to compare our results to other simulations, so we turn to the \textit{gap creation rate} developed by \citet{2012ApJ...748...20C}. The gap creation rate is the number of gaps that appear per unit time and is normalized by the stream's length. For our simulations, this rate is given by: \begin{equation} \label{eq:gap_creation_rate} \mathcal{R}_{\textrm{Pal 5}} =  \frac{1}{T}\int_{0}^T l^{-1}(t) \sum_i \delta(t-t_i) dt,\end{equation}where $T$ is the total integration time, $l(t)$ is the length of the stream, and $\sum_i \delta(t-t_i)$ sums over the gap occurrences, with $i$ indexing over the number of gaps in a given simulation. Here, $\delta$ represents the Dirac delta function. This expression can be simplified to:\begin{equation}\mathcal{R}_{\textrm{Pal 5}} =  \frac{1}{T} \sum_i \frac{1}{l (t_i)}. \end{equation}
    
    This computation allows us to analyze the distribution of gap creation rates across all simulations. Notice that since the gap creation rate \textit{adds in parallel}, naturally, gaps that occur at earlier times when the stream was shorter are weighted higher than those that occur when the stream is longer. Fig.~\ref{fig:gapcreationrate} presents these results which are is roughly consistent with a simple estimate of the average gap creation rate: with 73 gaps over 5~Gyr of integration time for a stream about 20 kpc in length, the naive estimate is approximately 0.015~km~s$^{-1}$~kpc$^{-2} $ (which is roughly equivalent to $0.015~\rm{Gyr^{-1}kpc^{-1}}$). This naive estimate is about double the weighted mean gap creation rate of 0.009~km~s$^{-1}$~kpc$^{-2}$ and is higher because it does not account for the growth of the stream over time, unlike Eq.~\ref{eq:gap_creation_rate}.

    \begin{figure}
      \centering
      \includegraphics[width=\linewidth]{gap_creation_rate.png}
      \caption{The distribution of the number of gaps normalized over the total integration time and unit stream length, as described by Eq.~\ref{eq:gap_creation_rate} for the whole set of 50 \texttt{full} simulations. }
      \label{fig:gapcreationrate}
    \end{figure}


    Lastly, we note that of the 73 observed gaps, only eight are in the trailing tail, and the rest are in the leading tail, which is a surprising result. A priori, since the star particles escape at similar rates from the L$_1$ and L$_2$ Lagrange points, each tail is of similar length and density. The main difference between the two tails is that the leading tail is closer to the Galactic center than the trailing tail by about 400~pc. Since the lengths are equal, and the offset between the tails is slight compared to the galactocentric distance of about 10 kpc, we expected the gaps in each tail to be more or less the same. We can compute the probability of observing the unequal occurrences through the binomial distribution. First, since the 44 gaps linked to NGC~2808 are the same fly-by, they are not independent events. We remove them from this consideration, which leaves 21 gaps in the leading tail and 8 in the trailing. The probability of observing up to 8 successes in 29 trials, given a 50\% chance of success, is 1.2\%--unlikely, but possible. Additionally, other perturbers impact at consistent times, which may violate the assumption of independent events, as seen with NGC~2808.


   
  \subsection{Impact geometry and parameters of the perturbers}\label{sect:geometry}
  
    \begin{figure*}
      \centering
      \includegraphics[width=\linewidth]{impact_geometry_statistics.png}
      \caption{The distribution and relationship between the impact variables from Eq.~\ref{eq:change_in_momentum} for all close fly-bys considered. The colors indicate the encounters that cause gaps and are the same as Fig.~\ref{fig:histogram_impact_time}, with white edges for visibility and binned in red for the histograms. The black histogram shows the close encounters that did not lead to gaps. Indeed, no obvious trend has emerged delimiting these planes into gap-producing or not.}
      \label{fig:impact_geometry_statistics}    
    \end{figure*}



    With the perturbers identified, we perform statistics to understand what conditions are necessary for a globular cluster to induce a gap on the Palomar~5 stream. We turn to impact theory, which in its simplest form is presented in works such as \citet{2008gady.book.....B}. Consider two particles: one stationary and the other moving past it. The impact parameter is the distance between the two particles at their closest approach. The \textit{impulse approximation} is employed, which assumes that the velocity of the perturber remains unchanged during the interaction. This assumption simplifies the computation.

    To understand how the impacted particle is perturbed, one needs to compute its change in momentum, which is determined by integrating the force acting on the particle throughout the interaction. A useful approximation for this change in momentum, per unit mass, is the force at the closest approach multiplied by an estimate of the interaction time:
    \begin{equation} \label{eq:change_in_momentum} \Delta p \approx \text{Force} \times \text{interaction time} = \frac{GM}{b^2} \times 2\frac{b}{\delta v} = 2\frac{GM}{b \delta v}, \end{equation}where $M$ is the mass of the perturber, $b$ is the impact parameter, $\delta v$ is the relative velocity of the perturber with respect to the particle, and $G$ is the gravitational constant. 


    This equation asserts that a more massive perturber, passing closer to the particle and moving more slowly, will have a greater impact. It is important to note that the momentum change is inversely proportional to the velocity of the perturber. Note that this contrasts with the intuition from elastic collisions, such as those between billiard balls, where higher velocities result in greater impacts.

    \citet{2015MNRAS.450.1136E} extended this impact theory from one point mass impacting another to studying how an extended body impacts a stream by quantifying the change in momentum of a given particle as a function of its distance from the point of greatest impact along the stream. \citet{2015MNRAS.450.1136E} models their perturber as a Plummer sphere, like in our simulations. Since the stream has length, one needs to consider the parallel and perpendicular components of the velocity to describe the impact fully. Consequently, five parameters determine the change in velocity of a given stream particle: $M$, $r_p$, $b$, $W_\parallel$, and $W_\perp$, which are the mass of the perturber, size of the perturber, impact parameter, parallel and perpendicular components of the relative velocity. As detailed in Appendix~\ref{sec:reconstruction}, we calculated these parameters for all our \texttt{full} simulations by selecting -- for each of them --  the strongest five flybys of a perturber with the Palomar~5 stream. Thus, we compute 250 impacts and flag those that give way to gaps. 


    Visual inspection of the five key impact parameters ($M$, $r_p$, $b$, $W_\parallel$, and $W_\perp$) did not reveal a clear distinction between flybys that create gaps and those that do not. Therefore, we only present the quantities from Eq.~\ref{eq:change_in_momentum} in Fig.~\ref{fig:impact_geometry_statistics}. 
    Note that this figure shows the total relative velocity rather than separating parallel and perpendicular components because, from a visual inspection, we could not find any specific trends when we plotted the two velocity components separately. We also excluded the characteristic cluster radius, which showed little correlation with the results, likely due to the narrow range of globular cluster radii (see Fig.~\ref{fig:mass_size_plane}). This factor might be more significant for dark matter sub-halos, where size variation is greater.
      
      
  
    While Fig.~\ref{fig:impact_geometry_statistics} demonstrates that mass, relative velocity, or impact parameter alone cannot predict gap formation, one interesting result emerges: impact parameters greater than 300~pc do not create gaps. The stream widths are roughly 200~pc, as seen in Appendix~\ref{sec:gallery_of_gaps}. This finding is even more evident when examining the $b$-$M$ plane. A series of perturbers at roughly $\sim8 \times 10^5 M_\odot$ highlights NGC~2808's flybys, where all encounters with impact parameters under 200~pc result in gaps, while those beyond this distance do not. In other words, even the most massive globular clusters with masses greater than about $10^6 M_\odot$ cannot cause gaps if their impact parameters are greater than roughly $300$~pc. Interestingly, even fast encounters ($\delta v > 300$~km/s) can produce gaps for impact parameter values below this threshold. Perhaps this is not surprising since the range of possible relative velocities is much less than mass and impact parameters, which vary by two and three orders of magnitude, respectively. In contrast, the relative velocities only vary by about a factor of three.

    \begin{figure}
      \centering
      \includegraphics[width=1\linewidth]{impact_geometry_statistics_deltaP.png}
      \caption{The distribution of imparted change in momentum (per unit mass) from a cluster flyby given by Eq.~\ref{eq:change_in_momentum}. The data set includes the top 5 strongest flybys from each simulation. Those that cause gaps are colored, stacked, and overlain atop those that do not--which is the gray distribution. Note that the meaning of the colors is the same as in Fig.~\ref{fig:histogram_impact_time}.}
      \label{fig:deltap}
    \end{figure}
      
    \begin{figure*}
      \centering
      \includegraphics[width=0.45\linewidth]{E_Lz_perturbers.png}
      \includegraphics[width=0.45\linewidth]{mass_size_plane.png}
      \includegraphics[width=0.45\linewidth]{impact_stats_phase_space_xy.png}
      \includegraphics[width=0.45\linewidth]{impact_stats_phase_space.png}
      \caption{\textit{Characteristics of gap causing clusters}. \textit{Top Left:} Energy-angular momentum space of the globular clusters in the simulations, with 50~$\times$~165 data points representing all sampled initial conditions. Clusters impacting Palomar~5 are shown with colored markers, large for the samplings that induce a gap and small for those that do not. The small gray dots represent the non-gap-causing clusters. The 50 white dots indicate Palomar~5's sampled initial conditions for the current day position. The light-pink dashed curve shows the circular velocity curve. \textit{Top Right:} Mass-size plane of the globular clusters in the simulations, with uncertainties on the masses indicated as vertical lines. We remind the reader that the globular cluster catalog currently does not provide uncertainties for clusters' characteristic radii. \textit{Bottom Left:} Palomar~5's orbit in the Galactocentric xy plane. The gray scale represents all 50 stacked orbits, with $\mathcal{P}$ indicating the probability of Palomar~5's position, normalized to $\mathcal{P}_\textrm{max}=1$. The colored markers indicate the position of the perturber when it impacted the stream and \textit{not} its present-day position. \textit{Bottom Right:} same as the bottom left but in the meridional plane. In all panels, the colors of the markers and histogram bars correspond to specific perturbers as specified in Fig.~\ref{fig:histogram_impact_time}.}
      \label{fig:mass_size_plane}
    \end{figure*}

      
    Once all the key impact parameters are estimated, we can use Eq.~\ref{eq:change_in_momentum} and calculate $\Delta p$, the change in momentum (per unit mass) imparted by a cluster flyby on Palomar~5 stream. Fig.~\ref{fig:deltap} shows the distribution of imparted change in momentum for all impacts that produce a gap compared to those that do not. On average, encounters that lead to gap creation impart a change in momentum on stream particles, which is a factor of 10 higher than encounters that do not form gaps (but with some overlap in the low-velocity tail). Interestingly, changes in momentum, which lead to gap creations, extend over a large range in velocities. There is a factor of about 100 between the smallest and largest changes with NGC~2808 (orange color in the histogram) imparting changes in the velocity of stream particles, which redistribute over the whole range of $\Delta p$. 

    In addition to characterizing the parameters governing cluster encounters with the stream, since we know which clusters have produced gaps on the tail of Palomar~5, we can also verify their orbital and structural properties. Fig~\ref{fig:mass_size_plane} shows just this, where we first show the clusters' mass and size (i.e., half-mass radius) that cause gaps on the tails of Palomar~5, dividing them from those that do not. As can be seen, no cluster with mass below $10^5 M_\odot$ causes gaps on the Palomar~5 stream, and all perturbers, except FSR~1758, have a half-mass radius below 10~pc. Even more interesting is their distribution in the E-L$_z$ plane, which shows that the clusters that cause gaps are on both direct and retrograde orbits (negative and positive values of $L_z$). However, all of the perturbers exist in an energy interval between $-2$ and $-1 \times10^5~\textrm{km}^2\textrm{s}^{-2}$, which is because only clusters within Palomar~5's orbital space can interact with the stream: clusters with higher orbital energies tend to have larger apocenters than that of Palomar~5 and thus spend most of their time away from Palomar~5's orbital volume. 
    
    Finally, it is worth commenting on the location of impacts with the stream, whether they occur when Palomar~5 is close to its pericenter. Fig.~\ref{fig:mass_size_plane}'s bottom panel shows that encounters can occur at all orbital phases of Palomar~5, when it is close to the pericenter, but also very far away from it, at the outskirts of its orbital space. However, when taken all together, the location of gap-creating impacts shows a strong negative correlation with the galactocentric radius $r$, with the number $N$ of encounters favorable to gap formation going as $N = -2.5r + 50$ (with a Pearson coefficient of -0.86). While there are more clusters near the Galactic center, clusters naturally spend more time near their apocenters, and the lower relative velocities in these regions should favor gap creation. However, this result suggests that the cluster Galactic number density outweighs these factors when determining the number of gaps. The results are for Palomar~5 only, and a future study would need to investigate streams along various orbits before generalizing this conclusion.
    

    %Our results are consistent with the findings from \citet{2021MNRAS.505.5978V}, who identified a wide range of orbital solutions for the least bound clusters, including retrograde and prograde orbits. In our potential model, only three cluster samplings had positive orbital energies.


  \subsection{Comparison to observations}

    We briefly compare our simulated gaps to the literature on Palomar~5. In the bottom panel of Fig.~\ref{fig:decomposition}, we compare the tracks of Palomar~5 that were compiled in \texttt{galstreams} by \citet{2023MNRAS.520.5225M}. The mid-point positions of the streams do not have the same galactocentric positions as Palomar~5 from Baumgardt's catalog, and the difference creates an offset when projected into tail coordinates. Moreover, since we sample the distances to Palomar~5, the galactocentric position within the Baumgardt catalog varies. To combat this, we position the mid-point of the \texttt{Galstream} tracks at the cluster's center of mass, allowing us to compare the length of the observed tracks to our simulated streams. We use the three tracks Pal5-PW19, Pal5-S20, and Pal5-I21 from \citet{2019AJ....158..223P}, \citet{2020MNRAS.495.2222S}, and \citet{2021ApJ...914..123I}, respectively. For each track, we find the distance from the cluster in either direction, count the number of gaps within this range, and present this in Fig.~\ref{fig:GapsWithinSight}. In the maximum limit, many gaps could appear at a rate of about one per realization. However, only a few gaps occur at the shortest reported stream length. \textbf{\paola{We note, in particular, that the gap generated by the recent perturbation induced on the stream by the passage of NGC~2808 (whose occurrence is very likely according to our models) sits in a portion of the simulated tail which is at the edge of the observed one (see bottom panel in Fig.~2). This element and the fact that this gap is skinny, because it is very recent, probably make its detection difficult. }}
      \begin{figure}
        \centering
        \includegraphics[width=\linewidth]{GapWithinSight.png}
        \caption{The distribution of gaps as a function of absolute distance from the center of mass of Palomar 5's globular cluster. We count the number of gaps within the observable range on an individual track basis, with track lengths determined by the minimum and maximum $x'$-coordinates from the bottom panel of Fig.~\ref{fig:decomposition}. The ranges for \citet{2019AJ....158..223P}, \citet{2020MNRAS.495.2222S}, and \citet{2021ApJ...914..123I} are shown for their respective dimensions, and the number of gaps within these ranges is indicated in the figure. Vertical bars mark the $x' > 0$ limit of the stream--we only show the right-hand side instead of both for clarity, as most gaps are located on the right-hand side of the stream in any case. }
        \label{fig:GapsWithinSight}
      \end{figure}    
    
    We observe no gaps within 3~kpc of the cluster in our simulation. There may be a few reasons for the absence of gaps in the portion of the tails closer to the cluster center. First, as \citet{2016MNRAS.457.3817S} demonstrated, the dispersion of action-frequencies in the stream plays a role. For instance, the frequency corresponding to the azimuthal action, $J_\phi$, is $\dot\theta_\phi = - \frac{\mathcal{\partial H}}{\partial J_\phi}$ and where $\theta_\phi$ is the angle describing the position of the particle phase space between momentum ($p_\phi$) and position ($\phi$) axes---where $\phi$ is the azimuthal angle between the x-y axes in physical space. Stream regions with well-separated frequencies are more susceptible to gap formation, while those with a wide frequency range (near the cluster) tend to erase the history of impacts. Thus, for a gap to form, the imparted change in frequency must exceed the range of frequencies in the impacted region. Therefore, the strong flybys close to the cluster were inconsequential for gap formation. 
    
    Another possible explanation is the different thicknesses of the simulated tails at different distances from the cluster's center. At distances less than 3~kpc from Palomar~5, the tails are skinny, with a typical thickness of less than 100~pc. To cause gaps in these regions, the clusters would have to pass close to the stream, with impact parameters similar to the thickness itself. Note that the thinness of the tails at these distances is probably a direct consequence of the initial parameters we chose for the simulation. For Palomar~5, 5~Gyr years ago, we assumed the same internal parameters (mass and size) as the cluster today. With such parameters, after 5~Gyr of evolution, our system has lost most of its mass, and therefore, the part of the tails closest to the cluster itself, whose density depends mainly on the most recent mass loss \citep[see, for example, Fig.~A.3 in][]{2012A&A...546L...7M}, is necessarily very thin because the simulated cluster has essentially no more mass to lose. This last point also has a consequence in the gap creation rate, which we derived at the end of Sect.~\ref{sect:geometry}: with only 70\% of the tail  ($\sim$ 14~kpc over 20~kpc, excluding the innermost $\pm 3$~kpc from the cluster center) suitable for forming gaps, the gap creation rates are about 50$\%$ higher than those estimated in the previous section, where values have been derived taking into account the full tail extent. This gap creation rate would still not be high enough to reproduce the number of gaps in Palomar~5's tails, as reported by \citet{2012ApJ...760...75C}. Their study suggested the presence of five gaps with a 99~\% detection confidence, leading to a gap creation rate of 0.17~Gyr$^{-1}$~kpc$^{-1}$. If correct, this rate would be too high to be explained by Galactic globular clusters only. 

\textbf{\paola{An additional explanation for the absence of gaps in the inner regions of a stream is given in App.xx. If a gap forms in a stream region where stars from the cluster coexist at different times, all stars lost at times before the impact acquire momentum and acceleration due to the perturber. Stars lost at different times move, however, in a given region of the stream with different velocities, and the same is true for the respective gaps, which will therefore lose spatial coherence over a time that is proportional to the size of the gap and inversely proportional to the velocity dispersion in that section of the stream. Since the inner regions of streams are those where stars lost at different times coexist more easily, this element must also be taken into account when discussing the visibility (or persistence) of gaps, and this independently of the nature of the perturber.}}

  
  
\section{Discussion}
  
  The simulations presented in this paper suggest that, in the last 5~Gyr of evolution, Palomar~5's stream could have experienced multiple close encounters with other Galactic globular clusters, some of which can create gaps -- even a few kpc wide -- in its tails. Currently, the literature debates whether or not a gap exists in the observed portion of Palomar~5 tails. \citet{2016ApJ...819....1I} found no statistically significant gap in Palomar~5 tails, while \citet{2017MNRAS.470...60E}, analyzing the same data-set as \citet{2016ApJ...819....1I}, suggested the presence of a few dips and gaps in the tails, at angular distances between $2^\circ$ and $9^\circ$ from the cluster center \citep[see also][]{ 2020ApJ...889...70B}. While our simulations produced 73 gaps across 50 realizations, only about 22 are beyond the current length of the observed portion of the stream, which means, on average, we obtain at least one gap from a globular cluster within the past 5~Gyr. However, we did not attempt to create mock observations or simulate a full detection process accounting for the challenges of disentangling field stars from stream stars. While such an analysis would be valuable, it is beyond the scope of this study.

  
  Our simulations produce a stream for Palomar~5 that is longer than the currently observed extent. In simulations, stream detections are straightforward because we can use reference runs to clearly separate stream particles from the field and compare against a known ``true'' structure. In contrast, observational data are inherently more challenging due to magnitude limits, contamination from field stars, and the lack of a ground truth for comparison. 
  
  The factors mentioned above could lead one to conclude that the number of gaps identified in this study could represent an upper limit. However, this conclusion is incomplete. Globular clusters lose mass and evaporate over time, leading to an incomplete catalog of perturbers. Moreover, the present-day masses used in our simulations are likely lower than the historical masses of these clusters. For example, \citet{2024ApJ...976...54P} conducted a study simulating the dissolution of a realistic globular cluster population to identify how many stellar streams we should expect in the Milky Way and used a mock catalog of globular clusters with masses above 10$^4 M_\odot$ totaling about 10,000 clusters. Their setup implies that more perturbers could have been present in the past, potentially increasing the frequency and number of gaps in Palomar~5's stream.
  

  We note that our results seem to be in tension with the conclusions of \citet{2019MNRAS.484.2009B}, who presented a numerical study of Palomar~5 tails, orbiting a Milky Way-like potential, where both dark matter sub-halos and baryonic sub-structures (Galactic bar, spiral arms, giant molecular clouds, globular clusters) were taken into account to quantify the importance of these latter in density variations in Pal5 streams. While their methods are extremely similar to ours, their analysis diverges significantly. Specifically, \citet{2019MNRAS.484.2009B} focused on examining power spectra, analyzing variations in the one-dimensional stream density in stellar counts along the length of the stream. Upon comparison with our simulations, we observe that the power spectra from our \texttt{full} simulations that include globular clusters and the \texttt{reference} simulations that do not significantly differ. We suggest that this may be due to the signal from only one or two gaps caused by globular clusters not being sufficient to produce notable differences in the overall power spectrum. Additionally, \citet{2019MNRAS.484.2009B} may not have inspected the profiles for individual gaps, which may be why they did not report them. Further investigations would be needed to confirm this interpretation and thoroughly assess the impact of globular clusters on stream density profiles. \\

  \textbf{ \paola{\citet{2017MNRAS.470...60E} is another world that discusses the impact of globular clusters in producing gaps on the Pal~5 stream. In section~6.3 of their article, \citet{2017MNRAS.470...60E} discuss the fact that globular clusters with masses greater than $10^6 M_\odot$ are rare in the Galaxy, especially at distances compatible with the orbit of Pal~5, while -- based on previous works -- they estimate that sub-halos of dark matter of similar mass are at least three times greater in number. This difference leads them to conclude that the gaps they report in the Pal~5 streams are more likely to be induced by dark matter sub-halos than by globular clusters. 
  However, as we show in this paper, even clusters with masses below $10^6 M_\odot$ can produce gaps. The clusters perturbing the Pal~5 stream are clusters with masses up to 10 times lower than those considered by \citet{2017MNRAS.470...60E}. It is thus possible that \citet{2017MNRAS.470...60E} have underestimated the impact of globular clusters' close passages on a stream such as Pal~5. It is more difficult, however, to make a comparative analysis between the role of clusters and sub-halos at equal stellar mass. Being less dense than globular clusters, sub-halos should produce less intense perturbations on streams (for fixed impact parameters and relative velocities). A systematic comparative analysis to quantify the role of clusters and sub-halos in producing gaps and perturbations in stellar streams still needs to be done.}}

  The impact of globular clusters' close interactions with stellar streams has also been the object of another recent paper by \citet{2022ApJ...941..129D}, who concluded that the chance for GD-1 gaps, which have been reported in several works \citep[see, for example, ][]{2019ApJ...880...38B,2018MNRAS.477.1893D,2020AAS...23533607D} to be produced by globular clusters is very low. This result is not necessarily in contradiction with ours since GD-1 has a pericenter which is almost twice that of Palomar~5 \citep[see, for example][]{2019MNRAS.486.2995M}. As discussed in Sect.~\ref{sect:geometry}, the number, $N$, of close encounters that lead to gap creation is anti-correlated with the distance $r$ to the Galactic center. If we naively use the same radial dependence of gaps from Palomar~5 for GD-1 by swapping a pericenter from 6~kpc to 16~kpc, we would reduce the number of gap-favorable impacts by more than a factor of 2. Moreover, we note that \citet{2022ApJ...941..129D} pre-selects the globular clusters that could have experienced a close encounter with the GD-1 stream by selecting only clusters that pass at a distance less than 0.5 kpc from the stream, having a relative velocity smaller than  300 km/s. As shown in our Fig.~\ref{fig:impact_geometry_statistics}, bottom-left panel, in the case of Palomar~5, this choice would lead to excluding most of the encounters favorable to gap creation, which turn out to have relative velocities above 300 km/s. It would be interesting to repeat a similar study as the one made by \citet{2022ApJ...941..129D} for GD-1, imposing no selection on possible candidate clusters.\\
  
  As already suggested in previous works which have studied the impact of baryonic structures on Palomar~5 tails \citep{2017NatAs...1..633P, 2019MNRAS.484.2009B}, this cluster may lie in a region of the phase-space which is not favorable to distinguish gaps created by dark matter sub-halos from gaps created by baryonic structures, such as the Galactic bar and giant molecular clouds. Our study shows that close encounters with globular clusters constitute a further element that confuses a simple interpretation of the observed Palomar~5 stream gaps (if any). Other clusters and streams in the orbital energy range of Palomar~5 may suffer from the same difficulty. Going to lower orbital energies worsens the situation because the effect of the Galactic bar, giant molecular clouds, and interactions with globular clusters becomes even more efficient. In the innermost regions of the Galaxy, where the density of dark matter sub-halos is maximal, globular cluster streams are intrinsically more difficult to find, in addition to the fact that the dynamical times in these regions become so small that the stars lost from globular clusters do not redistribute themselves for the most part into thin structures \citep[see][]{2023A&A...673A..44F}. It is thus probably only at larger distances from the Galactic center than those spanned by Palomar~5's orbit that the impact of dark matter sub-halos may become dominant, but bear in mind that at these distances, the number density of sub-halos also decreases. In the future, it will be interesting to apply the type of study conducted here to the whole set of streams to quantify the regime in which they are favorable to the creation of gaps from baryonic structures.
  

  
\section{Conclusions}
  Our study demonstrates that globular cluster flybys can produce density gaps in the stellar streams of Palomar~5. The occurrence and characteristics of these gaps depend on the stream's dynamical and structural properties, the perturber's mass, and the impact parameter. While our simulations predict the formation of gaps in Palomar~5's tails, the predicted gaps do not align with the regions of the stream currently observed. Several factors contribute to the absence of simulated gaps in the observed portions of Palomar~5's tails, including the stream's varying thickness, the dispersion of action frequencies near the cluster, and the initial conditions adopted in our simulations. 

  The broader implications of our findings indicate that globular cluster interactions add a layer of complexity to interpreting stellar stream substructures, complicating efforts to distinguish between baryonic and dark matter-induced gaps. While Palomar~5's phase-space region may not be ideal for isolating the impact of dark matter sub-halos, extending this analysis to other streams, particularly those at larger galactocentric distances, could provide clearer insights. 

  Future work should involve a systematic comparison of gap creation rates across various Galactic potentials and extend the scope to a wider range of streams and globular clusters. Such a work could disentangle regimes where baryonic and dark matter-induced substructures can dominate gap creation, shedding light on the elusive influence of dark matter sub-halos on stellar streams. Additionally, we can continue to add realistic physics to the Galactic environment, such as the merger of the Sagittarius dwarf galaxy, the passages of the Large and Small Magellanic clouds, as well as a time-evolving globular cluster population that compensates for the clusters' mass loss, evaporation, and similarly add members from the current incomplete census.


  
\section*{Data Availability}

  The code used to produce the data in these simulations is publicly available at https://github.com/salvatore-ferrone/tstrippy. Examples of the installation and use of the code are provided at https://tstrippy.readthedocs.io. The simulations will also be made publicly available at etidal-project.obspm.fr.



\begin{acknowledgements}
  This work has made use of the computational resources available at the Paris Observatory, as well as those obtained through the DARI grant A1020410154 (PI: P. Di Matteo) and of the Astropy, Numpy, and Matplotlib libraries (Astropy Collaboration 2013, 2018; Harris et al. 2020; Hunter 2007). SF, PDM, and MM thank the École Doctorale 127 for its financial support. MM thanks the CNR STM program, thanks to which the collaboration on this research topic began. 
\end{acknowledgements}




\bibliographystyle{aa} % or another style like plain, unsrt, etc.
\bibliography{bibliography} % replace 'references' with the name of your .bib file



\begin{appendix}
  
  
  \section{Gap Detection} \label{sec:gap_detection}
    For each of the 50 simulations, we compare the final snapshots between the \texttt{reference} and \texttt{full} simulations using the tail coordinate system, as shown in Fig.~\ref{fig:TailCoordinates}. We only saved the \texttt{reference} simulations at the final time-stamps, thus from Eq.~\ref{eq:data_volume_estimate} where $N_{ts}$=1, leading to a data volume of about one hundred measly megabytes. We inspect these differences by generating 2D density maps of the streams. Additionally, we marginalize over the $y'$-coordinate to produce 1D density profiles along the $x'$-axis. We show these comparisons in the results section (see Fig.~\ref{fig:profiles}).
    \begin{figure}
      \centering
      \includegraphics[width=\linewidth]{tailcoordinates.png}
      \caption{A demonstration of the transformation from galactic coordinates to tail coordinates. The black dot represents the globular cluster, while the thick black line shows a segment of its orbit. The star symbol indicates a star particle. The red vector points from the nearest point on the cluster's orbit to the star particle. The galactocentric position vector is the $y'$-axis. The local orbital plane, the cross-product between the orbit's local position and velocity vector, defines the $z'$-axis. We project the red vector on each of these axes. We measure the x' coordinate as the path length along the orbit from the cluster to the nearest point. Positive $x'$, $y'$, $z'$ indicate that a star is ahead of the cluster, farther from the galactic center, and above the orbital plane, respectively.}
      \label{fig:TailCoordinates}
    \end{figure}
  
    \begin{figure*}
      \centering
      \includegraphics[width=\linewidth, trim=20 0 15 0]{monte-carlo-009-pouliasis2017pii-GCNBody-2000-milisigma-5-noisefactor-20-boxcarindexlength-shifted-0.png}
      \caption{A comparison between the density maps and profiles of the \texttt{full} and \texttt{reference} simulations is presented. The blue vertical bars highlight the locations where the \texttt{full} simulation is less dense than the \texttt{reference} simulation by 2-$\sigma$. We do not consider bins below the noise threshold when measuring the differences between the two 1D profiles. We smoothed the 1D profiles with a median box-car filter.}
      \label{fig:profiles}
      \end{figure*}

    To construct the 1D density profiles, we bin the data using the $\sqrt{N}$ rule, where $N$ is the number of data points ($N_p = 10^5$). After binning the 1D profiles, we apply a median boxcar smoothing technique. At each bin, we select a number of adjacent data points from both sides, place them in a list, and replace the central value of the bin with the median. We use 10 adjacent points per side, corresponding to a smoothing length of approximately 1~kpc. This procedure reduces high-frequency noise and smooths the profiles. For instance, notice the absence of a high mass peak indicating the center of mass in the bottom panel of Fig.~\ref{fig:profiles}.

    With the smoothed 1D density profiles in hand, we search regions where the \texttt{full} simulations are significantly under-dense compared to \texttt{reference} simulations, surpassing stochastic fluctuations. We first impose a signal-to-noise ratio threshold, $\mathcal{SNR}$. The signal is the log of the counts per bin from the \texttt{reference} 1D density profile; we propagate errors assuming a Poisson distribution. We then compute a threshold for the number of counts in the \texttt{reference} simulation, $N_v$, using the transcendental equation:
    \begin{equation}
        \mathcal{SNR} = \ln(10) \log_{10}\left(N_v\right) \sqrt{N_v}.
      \end{equation} \label{eq:density_threshold}
    By setting $\mathcal{SNR} = 5$, we solve for $N$ using \texttt{scipy.optimize.fsolve}, finding that $N$ must be greater than 7. After discarding insignificant bins (i.e., those with counts below the threshold), we compute the log ratio of the counts between the \texttt{reference} and \texttt{full} simulations:
    \begin{equation}
        \mathcal{R}_i = \log_{10}\left(\frac{N_{f,i}}{N_{v,i}}\right),
      \end{equation}
    where $\mathcal{R}_i$ is the log ratio, $N_{f,i}$ are the counts from the \texttt{full} simulation, and $N_{v,i}$ are the counts from the \texttt{reference} simulation for each bin $i$. We then analyze the $\mathcal{R}_i$ distribution. If the differences between the density profiles are primarily due to stochastic processes of similar magnitude, this distribution should resemble a Gaussian, as expected from the central limit theorem. Thus, we flag all regions where the density is underdense by more than two standard deviations, which should highlight regions whose underdensity is unlikely to be the result of the sum of stochastic processes but rather the passage of another globular cluster. 

    However, this method has its limitations, especially when detecting smaller gaps. As outlined by \citet{2015MNRAS.450.1136E}, since gap growth is a dispersion phenomenon, a small gap is not indicative of a weak impact but a recent one. Additionally, since our streams have finite width, some gaps are oblique with respect to the stream axis. In such cases, marginalizing over $y'$ erases the gap's signal, making it impossible to detect in a 1D profile. This limitation is particularly evident in gaps caused by NGC~2808, as discussed in the results. Therefore, this quantitative analysis serves as an \textit{aid} to visual inspection rather than a complete substitute for it. This method helps with significant, subtle gaps the eye does not notice in the 2D maps. Appendix~\ref{sec:gallery_of_gaps} presents these profiles.


  \section{Perturber Identification} \label{sec:Perturber_Identification}

    We seek to answer a key question: From the gaps present at the end of the simulation, who caused them? To address this, we examine the evolution of stream density over time. Instead of using the x'-coordinate, we introduce $\tau$, which represents time rather than distance. Specifically, $\tau$ indicates how long a cluster will take to reach a given point in its orbit or how long ago it passed. This choice of coordinates is advantageous because the growth of the stream is approximately linear in $\tau$. In contrast, in physical space, streams on eccentric orbits expand and contract depending on the orbital phase.


    \citet{2016MNRAS.457.3817S} extended the analysis of \citet{2015MNRAS.450.1136E}, demonstrating that action-angle variables provide a useful coordinate system for analyzing stream evolution, as actions are conserved quantities and their associated angles grow linearly over time. Although we became aware of this work only after completing our analysis, we note that $\tau$ is a suitable approximation and behaves similarly to the angle variable corresponding to the azimuthal action: $\tau \approx \theta_{\phi, i} - \theta_{\phi,\text{GC}}$.

    The core of our analysis is presented in Fig.~\ref{fig:force-on-orbit}. The bottom panel shows the evolution of the stream density over time. To avoid extremely low-density regions at the stream's edges, we applied the same density threshold as from Eq.~\ref{eq:density_threshold} to focus on the more significant areas of the stream. Next, we modeled Palomar~5's orbit as a proxy for its stream and sampled points along the orbit to measure the gravitational force exerted by other globular clusters. The top panel of Fig.~\ref{fig:force-on-orbit} shows how the total gravitational acceleration on Palomar~5's stream evolves over its length throughout the simulation.

    \begin{figure*}
      \centering
      \includegraphics[width=\linewidth]{force_on_orbit-monte-carlo-009.png}
      \caption{This figure demonstrates how we determined which globular clusters were responsible for the gaps. The y-axis is $\tau$, a coordinate in units of time that indicates how far ahead or behind it is from a globular cluster. The x-axis is the simulation time, $t$, where 0~s km~kpc$^{-1}$ indicates the present time. The bottom plot showcases the evolution of the stream density over simulation time. We used the density to determine a suitable stream length. Subsequently, we used this length to extract a piece of Palomar~5's orbit. This orbital segment approximates the stream. Then, we compute the gravitational force from all other stream stand-in clusters, shown in the top plot. The gravitational force is measured in acceleration and is given in integration units: km$^2$~kpc$^{-1}$~s$^{-2}$. Moments of high acceleration indicate the passage of another cluster. The red circles indicate the top 5 strongest passages, as well as the names of the clusters. The example shown in this plot is the same simulation as Fig.~\ref{fig:stream_on_sky}.}
      \label{fig:force-on-orbit}
    \end{figure*}  


    We then used \texttt{scipy}'s \texttt{ndimage} \citep{2020NatMe..17..261V} package to identify the top five local maxima in the data space of gravitational acceleration $\vec{g}$ as a function of time $t$ and the stream coordinate $\tau$. First, we smooth the data space by taking a 5-point moving average kernel. Secondly, we use a maximum filter to locate coordinates in the ($t,\tau$) data plane that are local maxima to at least 10 adjacent data points. We order these locations and save the top five strongest interactions. Then, we iterated over the contributions of individual globular clusters to determine which cluster contributed the most to each peak in $\vec{g}$. We label each significant peak with the corresponding globular cluster.


    Afterward, we cross-referenced these peaks with the locations of the gaps identified by studying the density maps and profiles from Fig.~\ref{fig:profiles}. The impact leaves a low-density wake in the ($t,\tau$) plane for large gaps resulting from strong interactions. the bottom panel of Fig.~\ref{fig:force-on-orbit} shows the wakes corresponding to the impacts of NGC~104 and NGC~7808.



    Fig.~\ref{fig:force-on-orbit} contains some interesting information. Notice the periodic ribbons of force in the $(t,\tau)$ plane. The ribbons are due to pericenter passages where Palomar~5 is getting closer to the center of mass of the globular cluster system. Additionally, for the impacts of NGC~104 and NGC~7078, wakes can be observed in the density map. Another important aspect is that the strongest peak in gravitational force does not necessarily create a gap. Notice how NGC~5272, which was labeled with 0 to indicate that it has the greatest local maxima, does not have a gap. The reason for this is manifold. For instance, the force needs to be modulated with time since the change in momentum is the determining factor and not the peak magnitude of the force.  Additionally, there is an offset of about 200~pc between the stream and the orbit, as seen when viewing the stream in tail coordinates, so peaks upon the orbit are good proxies for the stream but are not definitive. We found that the top five greatest impacts accounted for all gaps, except for Sampling~014 as shown in Fig.~\ref{fig:gallery3}, whose gap from NGC~6584 corresponded to the 7th peak. 

    We compile the results of this analysis into a table. Each row of the table corresponds to a gap; its corresponding suspects are the columns. The culprit is labeled as \texttt{TRUE}. For a handful of simulations, to double-check that we make the correct verdict, we recompute the simulations, yet individually adding one globular cluster at a time. As a result, we can confirm that singular gaps arise from the suspected clusters. Fig.~\ref{fig:decomposition} shows one such example. 



    \section{Reconstruction of the impact geometry} \label{sec:reconstruction}

    As discussed in Sect~\ref{sect:geometry},  five parameters determine the change in velocity of a given stream particle: $M$, $r_p$, $b$, $W_\parallel$, and $W_\perp$. In the following, we describe how we estimated these parameters during impacts in our simulations.
    To achieve this, we identify the impact of the most significant clusters, as determined in the previous analysis in Sec.~\ref{sec:Perturber_Identification}. Then, we refine these estimates to pinpoint the exact location of the impact along the stream and the precise moment it occurred. To do so, we fit a third-order parametric polynomial to the stream using the saved snapshots from our simulations:
      \begin{equation}
        \vec{s}(\tau) = 
        \left\{
          \begin{aligned}
            x(\tau) &= a_0 + a_1 \tau + a_2 \tau^2 + a_3 \tau^3 \\ 
            y(\tau) &= b_0 + b_1 \tau + b_2 \tau^2 + b_3 \tau^3 \\
            z(\tau) &= c_0 + c_1 \tau + c_2 \tau^2 + c_3 \tau^3
          \end{aligned}
        \right.
        \end{equation}  
      where $x$, $y$, and $z$ represent the parametric line describing the stream in galactocentric coordinates, $\tau$ is the stream coordinate in time as described in the Appendix~\ref{sec:Perturber_Identification}, and is used as the independent variable to parameterize the position along the stream. The coefficients $a_i$, $b_i$, and $c_i$ are the polynomial coefficients. We found that a second-order polynomial was insufficient to capture the curvature along the full length of the stream, with divergence at the ends of the tails. A third-order polynomial was sufficient and desirable, as the lowest order adequately captures the stream's path over the entire length under consideration.

      In this analysis, we only consider one side of the stream. For instance, if the impact candidate was in the leading tail, only the star particles with $\tau > 0$ are used to constrain the stream track. The polynomial coefficients were determined through a minimization method using the Nelder-Mead algorithm from \texttt{scipy}'s optimization package.

      Since we saved the simulation snapshots at a temporal resolution of 1~Myr--rather than at the integration time-step, which would have generated excessive data, we must interpolate between snapshots to more precisely estimate the impact geometry. We fit the stream's shape with a parametric third-order polynomial at the five time steps surrounding the approximate impact time. This time is a period of 5~Myr, sufficiently covering the interaction time. The interaction time can be estimated as $t \approx \frac{100~\text{pc}}{300~\frac{\text{km}}{\text{s}}} \approx 0.3~\text{Myr}$.

      Then, we use a cubic spline interpolation for the coefficients describing the stream's shape, which allows us to describe each polynomial coefficient as a function of time. Consequently, we can parameterize the stream as a function of both simulation time and position along the stream:
      \begin{equation}
        \vec{s}(t,\tau) = 
        \left\{
        \begin{aligned}
          x(t,\tau) &= a_0(t) + a_1(t)\tau + a_2(t) \tau^2 + a_3(t)\tau^3 \\ 
          y(t,\tau) &= b_0(t) + b_1(t)\tau + b_2(t) \tau^2 + b_3(t)\tau^3 \\
          z(t,\tau) &= c_0(t) + c_1(t)\tau + c_2(t) \tau^2 + c_3(t)\tau^3.
          \end{aligned}
        \right.
      \end{equation}
      The values of the coefficients as a function of time are obtained through linear interpolation, ensuring that the coefficients at the snapshot times match the values constrained by the simulation data.

      Next, we fit the trajectory of the perturber with a second-order polynomial. With equations for both the stream and the perturber as functions of time, we identify the time and location of impact by minimizing a cost function, defined as the distance between the stream and the perturber:
      \begin{equation} 
        b(t, \tau) = \left\lVert \vec{s}(t, \tau) - \vec{p}(t) \right\rVert, 
        \end{equation}
      Where $\vec{s}(t, \tau)$ is the galactocentric position of a point on the stream, $\vec{p}(t)$ is the position of the perturber, and $b$ is the distance between the two. The minimum value of $b$, denoted as $\text{min}(b)$, represents the impact parameter. We perform the minimization using \texttt{scipy}'s optimization package with the \textit{L-BFGS-B} method, which allows us to place bounds on $t$ and $\tau$, ensuring no extrapolation occurs \citep{davidon1991variable}.

      Once this minimization is done, determining the relative velocity becomes straightforward. Since the minimization provides the impact parameter, time of impact, and the corresponding value of $\tau$, we can compute the derivatives of the parametric equations at $t_{\text{min}}$ and $\tau_{\text{min}}$. The parallel and perpendicular components of the perturber's velocity relative to the stream are given by:
      \begin{equation}
        \begin{aligned}
          \delta \vec{v} &=\vec{v_p} - \vec{v_s} \\
          w_\parallel &= \left(\delta \vec{v}\right)\cdot \hat{v_s}\\  
          w_\perp &=  \sqrt{\Delta v ^2 - w_\parallel ^ 2}
          \end{aligned}
        \end{equation}
      where $\vec{v}_p$ and $\vec{v}_s$ are the velocities of the perturber and the stream, respectively. We compute the strongest five flybys for each of the 50 simulations. Thus, we created a sample of 250 impacts and flagged those that give rise to gaps. We refer the reader to Sect.~\ref{sect:geometry} for the presentation and discussion of the results.



\section{Survival of gaps in streams emerging from more massive globular clusters}\label{sec:gaps_vs_gcmass}

\textbf{\paola{In Section~\ref{sec:mass_loss}, we emphasized that the conditions chosen to simulate the formation and evolution of streams around Pal~5 are probably unrealistic. By choosing, as we did, the same values for the mass and size of the cluster 5 billion years ago as the cluster has today, we did not take into account the loss of mass and internal evolution of the cluster over time. In particular, the velocity dispersion of the stars in a cluster and the velocity dispersion of the stars leaving the cluster and entering the stream depend on the cluster's mass. It is therefore legitimate to ask whether, using a progenitor with a different mass and/or size, the gaps survive and whether, in particular, gaps formed several billion years ago can still be visible today. }}

\begin{figure*}
    \centering
    \includegraphics[width=1\linewidth]{gap_no_more.png}
    \caption{When the mass of Palomar~5 is increased, the gap is lost.}
    \label{fig:gap_no_more.png}
\end{figure*}

\textbf{\paola{While we anticipate that a specific study on this aspect is in preparation (Ferrone et al, in prep), we would like to preview a few results here.
Fig.~\ref{fig:gap_no_more} (top and bottom panels) shows, respectively, a stream generated in one of our simulations, using as initial mass (i.e., 5 billion years ago) for Pal~5 one similar to the current one or a larger mass ($xx M_\odot$). For simplicity, in both experiments, we left the cluster size unchanged. In both cases, a gap forms due to an encounter (specifically with the cluster NGCxxx) that occurred xx billion years ago. However, while in Fig.~\ref{fig:gap_no_more}, top panel, the gap persists for xx billion years, in Fig. xx (bottom panel), the gap is no longer observable at the end of the simulation. Looking more closely at the reasons for this difference, we see (Fig.\ref{fig:decoherence_shocked_outflow}) that the gap formed xx billion years ago in Fig. xx (bottom) survives in all the populations lost from the cluster before the impact and which had time to reach the part of the tail affected by the passage of NGCxxx. What happens, however, is that after a coherent gap has formed in the tail, and in particular in the populations of stars in this part of the tail that escaped from the cluster at different times, in each of these populations the respective gap tends to travel along the streams at different speeds, which leads to a phase shift of the gap and its loss of visibility. In other words, the gap can survive for billions of years in each population of stars that left the cluster at different times, but it is no longer. Still, initially coherent and therefore visible because each of these populations travels along the tail (and drags a gap with it) at different speeds. The loss of coherence occurs at a time $t_{visibility}$ which is directly proportional to the gap size and inversely proportional to the velocity dispersion in that part of the stream. So, if populations of stars lost at different times co-exist in the portion of the stream where the impact occurs, the gap will remain visible for a time that depends on the mass of the progenitor system at the time these stars escaped. From this, we can understand that various factors determine the visibility of a gap in a stream. Mass affects the velocity dispersion in a given region of the stream, but this velocity dispersion, in turn, depends on the history of mass loss of the cluster. Suppose stars dominate a given region of the stream, all lost simultaneously from the cluster. In that case, the resulting velocity dispersion is lower than if various populations coexist in the same region, which has implications for these structures' persistence. }}


\begin{figure*}
    \includegraphics[width=\linewidth]{decoherence_shocked_outflow.png}
    \caption{Nice}
    \label{fig:decoherence_shocked_outflow}
\end{figure*}



  \section{Gallery of Gaps} \label{sec:gallery_of_gaps}
    Figures~\ref{fig:gallery0}-\ref{fig:gallery11} include all of the realizations of the \texttt{full} simulations of Palomar~5 in tail coordinates. A red arrow aids the reader in identifying the gap, accompanied by the responsible globular cluster. For the gaps that are not easily visible, we show the 1D profiles showing the significant under-densities compared to the \texttt{reference} simulations. For instance, the second and last panels of Fig.~\ref{fig:gallery0}. However, marginalizing the 2D distribution to 1D can erase the signal of oblique gaps. Thus, not all gaps in the 2D space are visible in the density profiles. For example, in \texttt{Sampling 000}, the gaps from NGC~2808 and NGC~5634 are not flagged as present in the marginalized density profile.

    \begin{figure*}
      \centering
      \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-000.png}
      % \includegraphics[width=\linewidth]{tau-profile-monte-carlo-000.png}
      % \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-001.png}
      % \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-002.png}
      % \includegraphics[width=\linewidth]{tau-profile-monte-carlo-002.png}
      \caption{First gap gallery. See the text in Appendix~\ref{sec:gallery_of_gaps} for a description.}
      \label{fig:gallery0}
      \end{figure*}    


    \begin{figure*}
      \centering
      \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-003.png}      
      % \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-004.png}
      % \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-005.png}
      % \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-006.png}
      % \includegraphics[width=\linewidth]{tau-profile-monte-carlo-006.png}
      \caption{Second gap gallery}
      \label{fig:gallery1}
      \end{figure*}        


    % \begin{figure*}
    %   \centering
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-007.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-008.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-009.png}      
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-010.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-011.png}
    %   \caption{Third gap gallery}
    %   \label{fig:gallery2}
    %   \end{figure*}        


    % \begin{figure*}
    %   \centering
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-012.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-013.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-014.png}      
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-015.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-016.png}
    %   \caption{Fourth gap gallery}
    %   \label{fig:gallery3}
    %   \end{figure*}        

    % \begin{figure*}
    %   \centering
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-017.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-018.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-019.png}      
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-020.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-021.png}
    %   \caption{Fifth gap gallery}
    %   \label{fig:gallery4}
    %   \end{figure*}        

    % \begin{figure*}
    %   \centering
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-022.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-023.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-024.png}   
    %   \includegraphics[width=\linewidth]{tau-profile-monte-carlo-024.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-025.png}
    %   \caption{Sixth gap gallery}
    %   \label{fig:gallery5}
    %   \end{figure*}        

    % \begin{figure*}
    %   \centering
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-026.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-027.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-028.png}
    %   \includegraphics[width=\linewidth]{tau-profile-monte-carlo-028.png}
    %   \caption{Seventh gap gallery}
    %   \label{fig:gallery6}
    %   \end{figure*}        

    % \begin{figure*}
    %   \centering      
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-029.png}    
    %   \includegraphics[width=\linewidth]{tau-profile-monte-carlo-029.png}  
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-030.png}
    %   \includegraphics[width=\linewidth]{tau-profile-monte-carlo-030.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-031.png}
    %   \caption{Eighth gap gallery}
    %   \label{fig:gallery7}
    %   \end{figure*}        


    % \begin{figure*}
    %   \centering
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-032.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-033.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-034.png}      
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-035.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-036.png}      
    %   \caption{Ninth gap gallery}
    %   \label{fig:gallery8}
    %   \end{figure*}    



    % \begin{figure*}
    %   \centering
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-037.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-038.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-039.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-040.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-041.png}      
    %   \caption{Tenth gap gallery}
    %   \label{fig:gallery9}
    % \end{figure*}        
    
    % \begin{figure*}
    %   \centering
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-042.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-043.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-044.png}
    %   \includegraphics[width=\linewidth]{tau-profile-monte-carlo-044.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-045.png}
    %   \caption{Eleventh gap gallery}
    %   \label{fig:gallery010}
    % \end{figure*}   

    % \begin{figure*}
    %   \centering
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-046.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-047.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-048.png}
    %   \includegraphics[width=\linewidth]{tau-profile-monte-carlo-048.png}
    %   \includegraphics[width=\linewidth]{gallery_of_gaps_monte-carlo-049.png}
    %   \caption{Twelfth gap gallery}
    %   \label{fig:gallery11}
    % \end{figure*} 


\end{appendix}

\end{document}